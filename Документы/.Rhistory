knitr::opts_chunk$set(echo = FALSE)
library(openxlsx)
library(readxl)
library(ggplot2)
library(Hmisc)
require(dplyr)
library(randomForest)
library(tidymodels)
Data_xlsx <- read_excel("Вар_44_Полные_данные.xlsx", sheet=1) #Считываем данные из файла
names(Data_xlsx)[3] <- "Среднегодовой.доход..тыс.." #Переименовываем колонки, в которых содержатся некорректные символы
names(Data_xlsx)[4] <- "Объем.потребленного.алкоголя.в.год..л."
names(Data_xlsx)[7] <- "Доля.от.дохода.семьи.которая.тратится.на.продовольствие..."
names(Data_xlsx)[9] <- "Издержки.сообщества.на.окружающую.среду..млн..."
names(Data_xlsx)[10] <- "Охват.беспроводной.связи.в.сообществе..."
names(Data_xlsx)[11] <- "Количество.смертей.от.вирусных.и.респираторных.заболеваний.в.сообществе..тыс..человек"
dataForForecast <- Data_xlsx[Data_xlsx$Ощущаемое.счастье == "Неизвестно",] #данные для предсказаний, ниже данные для обучения
Data  <- Data_xlsx[Data_xlsx$Ощущаемое.счастье != "Неизвестно",]
indHappy <- factor(Data$"Ощущаемое.счастье", levels = c("Hopeless","Depressed","Suffering",
"Strugglng","Coping","Just ok",
"Doing well", "Blooming", "Thriving",
"Prospering"),
labels=c(1,2,3,4,5,6,7,8,9, 10)) #Создаем фактор, ставящий в соответствие каждому слову из Ощущаемого счастья число согласно шкале Кантрила
Data <- cbind(Data, indHappy) #Добавляем колонку, в которой слово в колонке Ощущаемое счастье ставится цифре согласно шкале Кантрила (ранее созданный фактор)
dataForHappy <- Data[,13:27] #Убираем колонки с признаками-причинами, т.к. пока они не нужны
dataForHappy <- dataForHappy[-14] #Убираем колонку ощущаемое счастье, т.к. далее будем работать с числом (колонка Уровень.счастья)
dataForMarkSocialSupport <- cbind(Data[,3:12],Data[,14]) #создадим несколько таблиц для показателей состояний (далее поясняется почему именно они важны для индекса счастья), чтобы было проще предсказывать показатель состояния
names(dataForMarkSocialSupport)[11]<-"Оценка.социальной.поддержки"
dataForWaitHealthyLife <- cbind(Data[,3:12],Data[,15])
names(dataForWaitHealthyLife)[11]<-"Ожидаемая.продолжительность.здоровой.жизни"
dataForIndFeelingCorruption<- cbind(Data[,3:12],Data[,18])
names(dataForIndFeelingCorruption)[11]<-"Индекс.отношения.к.коррупции"
dataForIndFamily <- cbind(Data[,3:12],Data[,22])
names(dataForIndFamily)[11]<-"Индекс.семьи"
dataForProductSafety <- cbind(Data[,3:12],Data[,23])
names(dataForProductSafety)[11]<-"Индекс.продовольственной.безопасности"
dataForHappy$indHappy <- as.integer(dataForHappy$indHappy)
cor(as.matrix(cbind(dataForHappy)), method = "pearson")
corMatrix <- as.data.frame(cor(as.matrix(cbind(dataForHappy)), method = "pearson"))
write.xlsx(corMatrix, "corMatrix.xlsx")
cor.test(dataForHappy$indHappy,dataForHappy$Оценка.социальной.поддержки)
cor.test(dataForHappy$indHappy,dataForHappy$Ожидаемая.продолжительность.здоровой.жизни)
cor.test(dataForHappy$indHappy,dataForHappy$Индекс.отношения.к.коррупции)
cor.test(dataForHappy$indHappy,dataForHappy$Индекс.семьи)
cor.test(dataForHappy$indHappy,dataForHappy$Индекс.продовольственной.безопасности)
dataForHappy$indHappy <- as.factor(dataForHappy$indHappy) #делаем фактор чтобы нарисовать плотности распределений различные для каждой из групп счастья (тюею для группы синдексом счастья=1, 2, и т.д.)
#теперь проанализируем с помощью визуального анализа, какие показатели важны
ggplot(dataForHappy, aes(x = Оценка.благополучия, colour =indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Оценка.социальной.поддержки, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Ожидаемая.продолжительность.здоровой.жизни, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Свобода.граждан.самостоятельно.принимать.жизненно.важные.решения, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.Щедрости, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.отношения.к.коррупции, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Оценка.риска.безработицы, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.кредитного.оптимизма, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.страха.социальных.конфликтов, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.семьи, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Индекс.продовольственной.безопасности, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Чувство.технологического.прогресса, colour = indHappy)) + geom_density()
ggplot(dataForHappy, aes(x = Чувство.неравенства.доходов.в.обществе, colour = indHappy)) + geom_density()
#Таким образом видно, что и в матрице корреляций и визуально счастье точно зависит от :
#"Оценка.социальной.поддержки","Ожидаемая.продолжительность.здоровой.жизни","Индекс.отношения.к.коррупции ","Индекс.семьи","Индекс.страха.социальных.конфликтов"
dataForHappy$indHappy <- as.integer(indHappy) #преобразуем стобец в число, т.к. подель может предсказывать количественный показатель
formula <- "indHappy~." #построим формулу: зависимость индекса счастья от всех показателей состояний
LM <- lm(formula, data=dataForHappy)
summary(LM) #посмотрим на параметры построенной модели
formula <- "Оценка.социальной.поддержки~." #для этого признака и каждого далее строим сначала формулу, как зависимость показателя от показателей причин (всех)
LM_full <- lm(formula, data=dataForMarkSocialSupport) #строим модель, обучаем ее на построенной ранее таблице из показателей причин и только данного показателя состояния
summary(LM_full)
#чтобы избежать переобучения модели - отбросим ненужные показатели, из полной модели уменьшаем количество показателей причин
formula1 <- "Оценка.социальной.поддержки ~ Объем.потребленного.алкоголя.в.год..л. +
Количество.лет.образования + Доля.от.дохода.семьи.которая.тратится.на.продовольствие... +
Издержки.сообщества.на.окружающую.среду..млн... + Волатильность.потребительских.цен.в.сообществе"  #запомним найденную формулу и проверим что точность осталась той же
LM1 <- lm(formula1, data=dataForMarkSocialSupport)
summary(LM1)
formulaMarkSocialSupport <- formula1  #запомним эту формулу как ту по которой будем делать предсказание, далее аналогично найдем формулы для еще 4 признаков состояний
formula <- "Ожидаемая.продолжительность.здоровой.жизни~."
LM_full <- lm(formula, data=dataForWaitHealthyLife)
summary(LM_full)
formula1 <- "Ожидаемая.продолжительность.здоровой.жизни ~
Среднегодовой.доход..тыс.. + Доля.от.дохода.семьи.которая.тратится.на.продовольствие... +
Коэффициент.Джини.сообщества + Издержки.сообщества.на.окружающую.среду..млн... +
Охват.беспроводной.связи.в.сообществе... +
Количество.смертей.от.вирусных.и.респираторных.заболеваний.в.сообществе..тыс..человек +
Волатильность.потребительских.цен.в.сообществе"
LM1 <- lm(formula1, data=dataForWaitHealthyLife)
summary(LM1)
formulaWaitHealthyLife <- formula1
formula <- "Индекс.отношения.к.коррупции~."
LM_full <- lm(formula, data=dataForIndFeelingCorruption)
summary(LM_full)
formula1 <- "Индекс.отношения.к.коррупции ~ Объем.потребленного.алкоголя.в.год..л. +
Доля.от.дохода.семьи.которая.тратится.на.продовольствие... +
Издержки.сообщества.на.окружающую.среду..млн... + Волатильность.потребительских.цен.в.сообществе"
LM1 <- lm(formula1, data=dataForIndFeelingCorruption)
summary(LM1)
formulaIndFeelingCorruption <- formula1
formula <- "Индекс.семьи~."
LM_full <- lm(formula, data=dataForIndFamily)
summary(LM_full)
formula1 <- "Индекс.семьи ~
Среднегодовой.доход..тыс.. + Объем.потребленного.алкоголя.в.год..л. +
Количество.лет.образования + Доля.от.дохода.семьи.которая.тратится.на.продовольствие... +
Коэффициент.Джини.сообщества + Волатильность.потребительских.цен.в.сообществе"
LM1 <- lm(formula1, data=dataForIndFamily)
summary(LM1)
formulaIndFamily <- formula1
formula <- "Индекс.продовольственной.безопасности~."
LM_full <- lm(formula, data=dataForProductSafety)
summary(LM_full)
formula1 <- "Индекс.продовольственной.безопасности ~
Среднегодовой.доход..тыс.. + Объем.потребленного.алкоголя.в.год..л. +
Количество.лет.образования+
Коэффициент.Джини.сообщества + Издержки.сообщества.на.окружающую.среду..млн... +
Количество.смертей.от.вирусных.и.респираторных.заболеваний.в.сообществе..тыс..человек +
Волатильность.потребительских.цен.в.сообществе"
LM1 <- lm(formula1, data=dataForProductSafety)
summary(LM1)
formulaProductSafety <- formula1
LM_MarkSocialSupport <- lm(formulaMarkSocialSupport, data=dataForMarkSocialSupport) #Обучим нашу модель на данных из сформированной в начале таблице (30000 строк из показателей причин + 1 показатель состояния)
summary(LM_MarkSocialSupport)
futureLM_MarkSocialSupport <- predict(object=LM_MarkSocialSupport, newdata=dataForForecast) #выполним предсказание на новых данных
dataForForecast$Оценка.социальной.поддержки <- futureLM_MarkSocialSupport #запомним предсказанные значения, затем сделаем для еще 4 показателей состояний тоже самое
LM_WaitHealthyLife <- lm(formulaWaitHealthyLife, data=dataForWaitHealthyLife)
summary(LM_WaitHealthyLife)
futureLM_WaitHealthyLife <- predict(object=LM_WaitHealthyLife, newdata=dataForForecast)
dataForForecast$Ожидаемая.продолжительность.здоровой.жизни <- futureLM_WaitHealthyLife
LM_IndFeelingCorruption <- lm(formulaIndFeelingCorruption, data=dataForIndFeelingCorruption)
summary(LM_IndFeelingCorruption)
futureLM_IndFeelingCorruption <- predict(object=LM_IndFeelingCorruption, newdata=dataForForecast)
dataForForecast$Индекс.отношения.к.коррупции <- futureLM_IndFeelingCorruption
LM_IndFamily <- lm(formulaIndFamily, data=dataForIndFamily)
summary(LM_IndFamily)
futureLM_IndFamily <- predict(object=LM_IndFamily, newdata=dataForForecast)
dataForForecast$Индекс.семьи <- futureLM_IndFamily
LM_ProductSafety <- lm(formulaProductSafety, data=dataForProductSafety)
summary(LM_ProductSafety)
futureLM_ProductSafety <- predict(object=LM_ProductSafety, newdata=dataForForecast)
dataForForecast$Индекс.продовольственной.безопасности <- futureLM_ProductSafety
dataForHappy$indHappy <- as.numeric(dataForHappy$indHappy)
formula <- "indHappy ~ Оценка.социальной.поддержки +
Ожидаемая.продолжительность.здоровой.жизни + Индекс.отношения.к.коррупции +
Индекс.семьи + Индекс.продовольственной.безопасности"
model <- lm(formula, data=dataForHappy)
summary(model) #Итак, мы нашли простую линейную модель, обучили ее на известных данных, но попробуем улучшить ее построив нелинейную модель
#добавляем различные степени и математические функции, ведь они могут повысить точность модели
formula <- "indHappy ~
Оценка.социальной.поддержки +
Индекс.семьи +
Ожидаемая.продолжительность.здоровой.жизни +
Индекс.продовольственной.безопасности +
Индекс.отношения.к.коррупции +
I(exp(Оценка.социальной.поддержки))+
I(exp(Ожидаемая.продолжительность.здоровой.жизни))+
I(exp(Индекс.отношения.к.коррупции))+
I(exp(Индекс.семьи))+
I(exp(Индекс.продовольственной.безопасности))+
I(Оценка.социальной.поддержки**(1/2))+
I(Ожидаемая.продолжительность.здоровой.жизни**(1/2))+
I(Индекс.отношения.к.коррупции**(1/2))+
I(Индекс.семьи**(1/2))+
I(Индекс.продовольственной.безопасности**(1/2))+
I(Оценка.социальной.поддержки**(1/3))+
I(Ожидаемая.продолжительность.здоровой.жизни**(1/3))+
I(Индекс.отношения.к.коррупции**(1/3))+
I(Индекс.семьи**(1/3))+
I(Индекс.продовольственной.безопасности**(1/3))+
I(Оценка.социальной.поддержки**(1/4))+
I(Ожидаемая.продолжительность.здоровой.жизни**(1/4))+
I(Индекс.отношения.к.коррупции**(1/4))+
I(Индекс.семьи**(1/4))+
I(Индекс.продовольственной.безопасности**(1/4))+
I(Оценка.социальной.поддержки**(1/5))+
I(Ожидаемая.продолжительность.здоровой.жизни**(1/5))+
I(Индекс.отношения.к.коррупции**(1/5))+
I(Индекс.семьи**(1/5))+
I(Индекс.продовольственной.безопасности**(1/5))+
I(Оценка.социальной.поддержки**2) +
I(Оценка.социальной.поддержки**3) +
I(Оценка.социальной.поддержки**4) +
I(Оценка.социальной.поддержки**5) +
I(Оценка.социальной.поддержки**6) +
I(Оценка.социальной.поддержки**7) +
I(Оценка.социальной.поддержки**8) +
I(Оценка.социальной.поддержки**9) +
I(Оценка.социальной.поддержки**10) +
I(Оценка.социальной.поддержки**11) +
I(Оценка.социальной.поддержки**12) +
I(Оценка.социальной.поддержки**13) +
I(Оценка.социальной.поддержки**14) +
I(Оценка.социальной.поддержки**15) +
I(Индекс.отношения.к.коррупции**2) +
I(Индекс.отношения.к.коррупции**3) +
I(Индекс.отношения.к.коррупции**4) +
I(Индекс.отношения.к.коррупции**5) +
I(Индекс.отношения.к.коррупции**6) +
I(Индекс.отношения.к.коррупции**7) +
I(Индекс.отношения.к.коррупции**8) +
I(Индекс.отношения.к.коррупции**9) +
I(Индекс.отношения.к.коррупции**10) +
I(Индекс.отношения.к.коррупции**11) +
I(Индекс.отношения.к.коррупции**12) +
I(Индекс.отношения.к.коррупции**13) +
I(Индекс.отношения.к.коррупции**14) +
I(Индекс.отношения.к.коррупции**15) +
I(Индекс.семьи**2) +
I(Индекс.семьи**3) +
I(Индекс.семьи**4) +
I(Индекс.семьи**5) +
I(Индекс.семьи**6) +
I(Индекс.семьи**7) +
I(Индекс.семьи**8) +
I(Индекс.семьи**9) +
I(Индекс.семьи**10) +
I(Индекс.семьи**11) +
I(Индекс.семьи**12) +
I(Индекс.семьи**13) +
I(Индекс.семьи**14) +
I(Индекс.семьи**15) +
I(Индекс.продовольственной.безопасности**2) +
I(Индекс.продовольственной.безопасности**3) +
I(Индекс.продовольственной.безопасности**4) +
I(Индекс.продовольственной.безопасности**5) +
I(Индекс.продовольственной.безопасности**6) +
I(Индекс.продовольственной.безопасности**7) +
I(Индекс.продовольственной.безопасности**8) +
I(Индекс.продовольственной.безопасности**9) +
I(Индекс.продовольственной.безопасности**10) +
I(Индекс.продовольственной.безопасности**11) +
I(Индекс.продовольственной.безопасности**12) +
I(Индекс.продовольственной.безопасности**13) +
I(Индекс.продовольственной.безопасности**14) +
I(Индекс.продовольственной.безопасности**15) +
I(Ожидаемая.продолжительность.здоровой.жизни**2) +
I(Ожидаемая.продолжительность.здоровой.жизни**3) +
I(Ожидаемая.продолжительность.здоровой.жизни**4) +
I(Ожидаемая.продолжительность.здоровой.жизни**5) +
I(Ожидаемая.продолжительность.здоровой.жизни**6) +
I(Ожидаемая.продолжительность.здоровой.жизни**7) +
I(Ожидаемая.продолжительность.здоровой.жизни**8) +
I(Ожидаемая.продолжительность.здоровой.жизни**9) +
I(Ожидаемая.продолжительность.здоровой.жизни**10) +
I(Ожидаемая.продолжительность.здоровой.жизни**11) +
I(Ожидаемая.продолжительность.здоровой.жизни**12) +
I(Ожидаемая.продолжительность.здоровой.жизни**13) +
I(Ожидаемая.продолжительность.здоровой.жизни**14) +
I(Ожидаемая.продолжительность.здоровой.жизни**15) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции) +
I(Индекс.семьи*Индекс.отношения.к.коррупции) +
I(Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции) +
I(Оценка.социальной.поддержки*Индекс.семьи) +
I(Оценка.социальной.поддержки*Индекс.продовольственной.безопасности) +
I(Индекс.продовольственной.безопасности*Индекс.семьи) +
I(Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции) +
I(Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи) +
I(Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни) +
I(Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**2) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**2) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**2) +
I((Оценка.социальной.поддержки*Индекс.семьи)**2) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**2 ) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**2) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**2) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**2 ) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**2 ) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**2 ) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**3) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**3) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**3) +
I((Оценка.социальной.поддержки*Индекс.семьи)**3) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**3) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**3) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**3) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**3) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**3) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**4) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**4) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**4) +
I((Оценка.социальной.поддержки*Индекс.семьи)**4) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**4) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**4) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**4) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**4) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**4) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**4) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**5) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**5) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**5) +
I((Оценка.социальной.поддержки*Индекс.семьи)**5) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**5) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**5) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**5) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**5) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**5) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**5) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**6) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**6) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**6) +
I((Оценка.социальной.поддержки*Индекс.семьи)**6) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**6) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**6) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**6) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**6) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**6) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**6) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции)**7) +
I((Индекс.семьи*Индекс.отношения.к.коррупции)**7) +
I((Индекс.продовольственной.безопасности*Индекс.отношения.к.коррупции)**7) +
I((Оценка.социальной.поддержки*Индекс.семьи)**7) +
I((Оценка.социальной.поддержки*Индекс.продовольственной.безопасности)**7) +
I((Индекс.продовольственной.безопасности*Индекс.семьи)**7) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции)**7) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**7) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни)**7) +
I((Индекс.продовольственной.безопасности*Ожидаемая.продолжительность.здоровой.жизни)**7) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни) +
I(Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности) +
I(Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности) +
I(Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи) +
I(Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности*Индекс.семьи) +
I(Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности) +
I(Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи) +
I(Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни)**2) +
I((Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**2) +
I((Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности*Индекс.семьи)**2) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**2) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**2) +
I((Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни)**3) +
I((Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**3) +
I((Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности*Индекс.семьи)**3) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**3) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**3) +
I((Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи)**4) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности)**4) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни)**4) +
I((Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**4) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**4) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**4) +
I((Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности*Индекс.семьи)**4) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**4) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**4) +
I((Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**4) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи)**5) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности)**5) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни)**5) +
I((Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**5) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**5) +
I((Оценка.социальной.поддержки*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**5) +
I((Индекс.отношения.к.коррупции*Индекс.продовольственной.безопасности*Индекс.семьи)**5) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.семьи)**5) +
I((Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**5) +
I((Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**5) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)+
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**4) +
I(Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)+
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**2) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**3) +
I((Ожидаемая.продолжительность.здоровой.жизни*Индекс.отношения.к.коррупции*Индекс.семьи*Индекс.продовольственной.безопасности)**4) +
I(Ожидаемая.продолжительность.здоровой.жизни*Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)+
I((Ожидаемая.продолжительность.здоровой.жизни*Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**2) +
I((Ожидаемая.продолжительность.здоровой.жизни*Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**3) +
I((Ожидаемая.продолжительность.здоровой.жизни*Оценка.социальной.поддержки*Индекс.семьи*Индекс.продовольственной.безопасности)**4) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)+
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**4) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни)+
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни)**3) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни)**4) +
I(Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**2) +
I((Оценка.социальной.поддержки*Индекс.отношения.к.коррупции*Индекс.семьи*Ожидаемая.продолжительность.здоровой.жизни*Индекс.продовольственной.безопасности)**3)"
LM2 <- lm(formula, data=dataForHappy)
summary(LM2) #Т.к. R^2 ~ 0.96 - достаточно высок, то протестируем эту модель
formulaHappy <- formula
